@page "/grupos"
@inject IHttpClientFactory HttpClientFactory

@*TODO: Poderia adicionar policy e roles, se necessário*@
<AuthorizeViewCustom>
<MudContainer MaxWidth="MaxWidth.False" Class="pt-4">
    <MudText Typo="Typo.h4" Class="mb-4">Grupos do Tenant</MudText>

    <DataGridCustom TItem="TenantGroupResponse"
                    Response="@response"
                    LoadDataAsync="LoadGrupoTenantDataAsync"
                    EmptyMessage="Nenhum Grupo Encontrador">

        <HeaderContent>
            <MudTh>ID</MudTh>
            <MudTh>Nome</MudTh>
            <MudTh>Descrição</MudTh>
            <MudTh>Data de Criação</MudTh>
        </HeaderContent>

        <RowTemplate Context="item">
            <MudTd DataLabel="ID">
                <MudText Typo="Typo.caption" Style="font-family: monospace;">
                    @item.Id
                </MudText>
            </MudTd>
            <MudTd>@item.DisplayName</MudTd>
            <MudTd>@item.Description</MudTd>
            <MudTd>@item.CreatedDateTime.ToString("dd/MM/yyyy HH:mm:ss")</MudTd>
        </RowTemplate>
    </DataGridCustom>
</MudContainer>
</AuthorizeViewCustom>
@code {

    private PaginatedResponse<TenantGroupResponse> response;

    public async Task<PaginatedResponse<TenantGroupResponse>> LoadGrupoTenantDataAsync(int pageNumber, int pageSize)
    {
        var client = HttpClientFactory.CreateClient("ServerApi");

        return await client.GetOrFailAsync<PaginatedResponse<TenantGroupResponse>>("api/tenant/groups".SetQueryParams(new PaginatedRequest
        {
            PageNumber = pageNumber,
            PageSize = pageSize
        }));

    }

}
