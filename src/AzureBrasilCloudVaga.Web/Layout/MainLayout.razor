@inherits LayoutComponentBase
@inject NavigationManager Navigation
@inject SignOutSessionStateManager SignOutManager 

@* Required *@
<MudThemeProvider />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />


<AuthorizeView>
    <Authorized>

        <MudLayout>
            <MudAppBar>
                <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@ToggleDrawer" />
                My Application
                <MudSpacer />
                <MudIconButton OnClick="@Logout" Icon="@Icons.Custom.Brands.GitHub" Color="Color.Inherit" />
               

                <MudDrawer @bind-Open="@_open" ClipMode="DrawerClipMode.Always" Elevation="1" Variant="@DrawerVariant.Mini">

                    <NavMenu></NavMenu>
                </MudDrawer>



            </MudAppBar>


            <MudMainContent>
                @Body
            </MudMainContent>
        </MudLayout>
  </Authorized>
  <NotAuthorized>
        @Body
  </NotAuthorized>
</AuthorizeView>



@code {
    private bool _open = false;

    private void ToggleDrawer()
    {
        _open = !_open;
    }

    private async Task Logout()
    {
        await SignOutManager.SetSignOutState();
        Navigation.NavigateTo("/authentication/logout");
    }
}